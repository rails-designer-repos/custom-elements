<h1>Messages</h1>

<div id="messages">
  <%= render @messages %>
</div>

<optimistic-form>
  <form action="<%= messages_path %>" method="post">
    <%= hidden_field_tag :authenticity_token, form_authenticity_token %>

    <%= text_area_tag "message[content]", nil, placeholder: "Write a message…", required: true %>

    <%= submit_tag "Send" %>
  </form>

  <template response>
    <%= render Message.new(content: "", created_at: Time.current) %>
  </template>
</optimistic-form>


<hr>

<h2>
  Using Turbo
</h2>

<%= form_with model: Message.new, data: { optimistic: true, optimistic_target: "optimistic-messages", optimistic_template: "message-template", optimistic_position: "append" } do |form| %>
  <%= form.text_area :content, placeholder: "Write a message…", required: true %>

  <%= form.submit "Send" %>
<% end %>

<template id="message-template">
  <%= render Message.new(content: "", created_at: Time.current) %>
</template>

<div id="optimistic-messages">
  <%= render @messages %>
</div>
